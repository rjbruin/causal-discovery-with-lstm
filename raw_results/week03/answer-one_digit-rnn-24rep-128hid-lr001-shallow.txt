# Predict final digit
# LSTM / Single digit / 24 repetitions / 128 hidden units / shallow dataset

C:\Anaconda\lib\site-packages\theano\scan_module\scan_perform_ext.py:133: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility
from scan_perform.scan_perform import *
Batch 1 of 33 (ends after 100000 samples)
Testing...

Duration: 662 seconds
Score: 36.17 percent
Prediction histogram:   {0: 14824, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 2 of 33 (ends after 66586 samples)
Testing...

Duration: 1208 seconds
Score: 36.20 percent
Prediction histogram:   {0: 8837, 1: 5987, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 3 of 33 (ends after 33172 samples)
Testing...

Duration: 1772 seconds
Score: 37.36 percent
Prediction histogram:   {0: 6624, 1: 0, 2: 7592, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 608, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 4 of 33 (ends after 133172 samples)
Testing...

Duration: 2332 seconds
Score: 37.01 percent
Prediction histogram:   {0: 7486, 1: 192, 2: 0, 3: 0, 4: 83, 5: 4234, 6: 0, 7: 2331, 8: 498, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 5 of 33 (ends after 99758 samples)
Testing...

Duration: 2874 seconds
Score: 37.78 percent
Prediction histogram:   {0: 7686, 1: 7138, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 6 of 33 (ends after 66344 samples)
Testing...

Duration: 3402 seconds
Score: 39.15 percent
Prediction histogram:   {0: 7839, 1: 2661, 2: 1271, 3: 168, 4: 1009, 5: 357, 6: 1159, 7: 102, 8: 29, 9: 229, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 7 of 33 (ends after 32930 samples)
Testing...

Duration: 3930 seconds
Score: 39.38 percent
Prediction histogram:   {0: 8634, 1: 1023, 2: 138, 3: 72, 4: 581, 5: 0, 6: 0, 7: 7, 8: 0, 9: 4369, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 8 of 33 (ends after 132930 samples)
Testing...

Duration: 4486 seconds
Score: 40.11 percent
Prediction histogram:   {0: 8059, 1: 2217, 2: 0, 3: 4, 4: 0, 5: 3582, 6: 2, 7: 24, 8: 71, 9: 865, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 9 of 33 (ends after 99516 samples)
Testing...

Duration: 5060 seconds
Score: 41.95 percent
Prediction histogram:   {0: 6616, 1: 2230, 2: 59, 3: 2259, 4: 0, 5: 16, 6: 27, 7: 0, 8: 3510, 9: 107, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 10 of 33 (ends after 66102 samples)
Testing...

Duration: 5605 seconds
Score: 43.34 percent
Prediction histogram:   {0: 6945, 1: 1481, 2: 1273, 3: 9, 4: 1332, 5: 530, 6: 964, 7: 535, 8: 952, 9: 803, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 11 of 33 (ends after 32688 samples)
Testing...

Duration: 6092 seconds
Score: 45.06 percent
Prediction histogram:   {0: 6805, 1: 1621, 2: 675, 3: 394, 4: 2292, 5: 20, 6: 273, 7: 37, 8: 377, 9: 2330, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 12 of 33 (ends after 132688 samples)
Testing...

Duration: 7022 seconds
Score: 50.24 percent
Prediction histogram:   {0: 5276, 1: 2184, 2: 898, 3: 122, 4: 49, 5: 1763, 6: 1095, 7: 21, 8: 2706, 9: 710, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 13 of 33 (ends after 99274 samples)
Testing...

Duration: 8044 seconds
Score: 57.76 percent
Prediction histogram:   {0: 5653, 1: 943, 2: 769, 3: 1898, 4: 999, 5: 375, 6: 1405, 7: 0, 8: 1471, 9: 1311, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 14 of 33 (ends after 65860 samples)
Testing...

Duration: 9045 seconds
Score: 51.13 percent
Prediction histogram:   {0: 7295, 1: 695, 2: 1270, 3: 312, 4: 1382, 5: 254, 6: 1520, 7: 63, 8: 484, 9: 1549, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 15 of 33 (ends after 32446 samples)
Testing...

Duration: 9954 seconds
Score: 68.42 percent
Prediction histogram:   {0: 5644, 1: 1381, 2: 703, 3: 1128, 4: 1660, 5: 226, 6: 1293, 7: 473, 8: 821, 9: 1495, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 16 of 33 (ends after 132446 samples)
Testing...

Duration: 10532 seconds
Score: 63.40 percent
Prediction histogram:   {0: 5394, 1: 962, 2: 1374, 3: 1179, 4: 433, 5: 787, 6: 1280, 7: 144, 8: 2137, 9: 1134, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 17 of 33 (ends after 99032 samples)
Testing...

Duration: 11054 seconds
Score: 70.45 percent
Prediction histogram:   {0: 5588, 1: 904, 2: 1529, 3: 1130, 4: 898, 5: 1140, 6: 1426, 7: 478, 8: 723, 9: 1008, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 18 of 33 (ends after 65618 samples)
Testing...

Duration: 11557 seconds
Score: 76.08 percent
Prediction histogram:   {0: 5446, 1: 1285, 2: 1091, 3: 974, 4: 1253, 5: 650, 6: 1506, 7: 440, 8: 1388, 9: 791, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 19 of 33 (ends after 32204 samples)
Testing...

Duration: 12065 seconds
Score: 81.64 percent
Prediction histogram:   {0: 5531, 1: 1129, 2: 1105, 3: 1111, 4: 1125, 5: 716, 6: 1141, 7: 1130, 8: 406, 9: 1430, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 20 of 33 (ends after 132204 samples)
Testing...

Duration: 12566 seconds
Score: 66.44 percent
Prediction histogram:   {0: 5049, 1: 1325, 2: 898, 3: 1413, 4: 847, 5: 952, 6: 1061, 7: 635, 8: 1325, 9: 1319, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 21 of 33 (ends after 98790 samples)
Testing...

Duration: 13046 seconds
Score: 78.17 percent
Prediction histogram:   {0: 5339, 1: 1306, 2: 1203, 3: 1031, 4: 1208, 5: 853, 6: 1476, 7: 441, 8: 1206, 9: 761, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 22 of 33 (ends after 65376 samples)
Testing...

Duration: 13552 seconds
Score: 80.88 percent
Prediction histogram:   {0: 5464, 1: 1267, 2: 1048, 3: 1261, 4: 1113, 5: 843, 6: 1167, 7: 697, 8: 1068, 9: 896, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 23 of 33 (ends after 31962 samples)
Testing...

Duration: 13957 seconds
Score: 80.34 percent
Prediction histogram:   {0: 5440, 1: 1181, 2: 1213, 3: 1094, 4: 1256, 5: 589, 6: 1365, 7: 720, 8: 416, 9: 1550, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 24 of 33 (ends after 131962 samples)
Testing...

Duration: 14450 seconds
Score: 81.40 percent
Prediction histogram:   {0: 5323, 1: 1136, 2: 1196, 3: 1038, 4: 879, 5: 1229, 6: 1172, 7: 860, 8: 1020, 9: 971, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 25 of 33 (ends after 98548 samples)
Testing...

Duration: 14878 seconds
Score: 88.17 percent
Prediction histogram:   {0: 5424, 1: 1219, 2: 1037, 3: 1067, 4: 1218, 5: 823, 6: 1372, 7: 626, 8: 1155, 9: 883, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 26 of 33 (ends after 65134 samples)
Testing...

Duration: 15313 seconds
Score: 85.38 percent
Prediction histogram:   {0: 5378, 1: 1160, 2: 1115, 3: 1265, 4: 1081, 5: 844, 6: 1325, 7: 920, 8: 1042, 9: 694, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 27 of 33 (ends after 31720 samples)
Testing...

Duration: 15746 seconds
Score: 83.67 percent
Prediction histogram:   {0: 5566, 1: 1029, 2: 1152, 3: 1176, 4: 1072, 5: 729, 6: 978, 7: 1019, 8: 761, 9: 1342, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 28 of 33 (ends after 131720 samples)
Testing...

Duration: 16199 seconds
Score: 87.55 percent
Prediction histogram:   {0: 5372, 1: 1210, 2: 1087, 3: 1111, 4: 1078, 5: 968, 6: 1203, 7: 811, 8: 958, 9: 1026, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 29 of 33 (ends after 98306 samples)
Testing...

Duration: 16656 seconds
Score: 88.40 percent
Prediction histogram:   {0: 5416, 1: 1251, 2: 1108, 3: 1128, 4: 1157, 5: 875, 6: 1087, 7: 885, 8: 992, 9: 925, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 30 of 33 (ends after 64892 samples)
Testing...

Duration: 17088 seconds
Score: 82.74 percent
Prediction histogram:   {0: 5408, 1: 1167, 2: 1153, 3: 1083, 4: 1136, 5: 850, 6: 1263, 7: 691, 8: 1161, 9: 912, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 31 of 33 (ends after 31478 samples)
Testing...

Duration: 17581 seconds
Score: 91.72 percent
Prediction histogram:   {0: 5350, 1: 1241, 2: 1130, 3: 1079, 4: 1152, 5: 956, 6: 1151, 7: 840, 8: 1055, 9: 870, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 32 of 33 (ends after 131478 samples)
Testing...

Duration: 18035 seconds
Score: 85.01 percent
Prediction histogram:   {0: 5339, 1: 1220, 2: 1130, 3: 1157, 4: 1007, 5: 879, 6: 1161, 7: 683, 8: 1201, 9: 1047, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}

Batch 33 of 33 (ends after 133414 samples)
Testing...

Duration: 18060 seconds
Score: 77.56 percent
Prediction histogram:   {0: 5659, 1: 1115, 2: 1311, 3: 1118, 4: 1067, 5: 1024, 6: 1213, 7: 812, 8: 823, 9: 682, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Ground truth histogram: {0: 5362, 1: 1203, 2: 1170, 3: 1104, 4: 1101, 5: 962, 6: 1113, 7: 873, 8: 1031, 9: 905, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0}
Confusion matrix:
1	2	3	4	5	6	7	8	9	10	11	12	13	14	15	16	17
1	5350	8	0	1	0	0	0	1	0	2	0	0	0	0	0	0	0
2	256	925	21	1	0	0	0	0	0	0	0	0	0	0	0	0	0
3	15	180	952	22	0	0	0	0	0	1	0	0	0	0	0	0	0
4	11	2	314	747	29	1	0	0	0	0	0	0	0	0	0	0	0
5	7	0	23	339	692	36	2	0	1	1	0	0	0	0	0	0	0
6	2	0	1	5	286	623	44	0	0	1	0	0	0	0	0	0	0
7	4	0	0	3	56	349	658	25	11	7	0	0	0	0	0	0	0
8	2	0	0	0	2	13	372	437	35	12	0	0	0	0	0	0	0
9	4	0	0	0	2	2	113	335	515	60	0	0	0	0	0	0	0
10	8	0	0	0	0	0	24	14	261	598	0	0	0	0	0	0	0
11	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
12	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
13	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
14	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
15	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
16	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
17	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
